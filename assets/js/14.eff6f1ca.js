(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{171:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._m(2),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._v(" "),n("hr"),t._v(" "),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),n("hr"),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._v(" "),n("hr"),t._v(" "),t._m(17),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/ohhoney1/Vue.js-Source-Code-line-by-line/blob/master/docs/12-the-generateComponentTrace-function-1.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("下一篇"),n("OutboundLink")],1),t._v("，我们将学习下 "),n("code",[t._v("generateComponentTrace")]),t._v(" 函数。")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"warn-函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#warn-函数","aria-hidden":"true"}},[this._v("#")]),this._v(" warn 函数")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" warn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" noop\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" generateComponentTrace "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// work around flow check")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hasConsole "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" console "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'undefined'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [...]")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("warn")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" trace "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("generateComponentTrace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("warnHandler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("warnHandler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" trace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hasConsole "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("silent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token string"}},[t._v("`[Vue warn]: ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("trace"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("默认情况下，"),s("code",[this._v("warn")]),this._v(" 函数什么也不做：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("noop")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" any"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// [. . . .]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" warn "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" noop\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("但是，当你处于开发环境时，"),s("code",[this._v("warn")]),this._v(" 就有用了。然后是做了什么呢？")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[n("code",[t._v("warn")]),t._v(" 函数接收两个参数 "),n("code",[t._v("msg")]),t._v(" 和 "),n("code",[t._v("vm")]),t._v("："),n("code",[t._v("msg")]),t._v(" 是一个字符串，"),n("code",[t._v("vm")]),t._v(" 是一个 "),n("code",[t._v("Vue")]),t._v(" 实例。例如：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Failed to mount component: template or render function not defined.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[n("code",[t._v("warn")]),t._v(" 函数初始化一个变量 "),n("code",[t._v("trace")]),t._v(" 。如果参数 "),n("code",[t._v("vm")]),t._v(" 传递给了 "),n("code",[t._v("warn")]),t._v(" 函数，"),n("code",[t._v("trace")]),t._v(" 赋值为调用 "),n("code",[t._v("generateComponentTrace")]),t._v(" 函数且参数为 "),n("code",[t._v("vm")]),t._v(" 的返回值。若参数 "),n("code",[t._v("vm")]),t._v(" 没传递给 "),n("code",[t._v("warn")]),t._v(" 函数，"),n("code",[t._v("trace")]),t._v(" 为一个空字符串。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("对于 "),s("code",[this._v("generateComponentTrace")]),this._v(" 的讨论，我们留到下次。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("warn")]),this._v(" 函数然后检查下 "),s("code",[this._v("config.warnHandler")]),this._v(" 是否已设置。根据 Vue.js 的 API，"),s("code",[this._v("config.warnHandler")]),this._v(" 表示“一个 Vue 运行时警告的通用处理函数。仅在开发环境下生效，生产环境无效”。它的用法如下：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("warnHandler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Component"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" trace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("正如上面所示，"),s("code",[this._v("Vue.config.warnHandler")]),this._v(" 是一个函数，接收参数为一个信息字符串，一个 Vue 实例，和 "),s("code",[this._v("trace")]),this._v("，允许你用函数体自定义警告处理信息。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[t._v("现在，我们继续回到 "),n("code",[t._v("warn")]),t._v(" 函数。如果已设置了 "),n("code",[t._v("config.warnHandler")]),t._v("，就会用 "),n("code",[t._v("call()")]),t._v(" 方法调用 "),n("code",[t._v("config.warnHandler")]),t._v("。"),n("code",[t._v("call()")]),t._v(" 方法把 "),n("code",[t._v("this")]),t._v(" 的值设为"),n("code",[t._v("null")]),t._v(" ，并传递了3个参数：\n(1)一个信息字符串，\n(2)一个 Vue 实例，\n(3)"),n("code",[t._v("trace")]),t._v("。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[t._v("另一方面，如果没设置 "),n("code",[t._v("config.warnHandler")]),t._v("，"),n("code",[t._v("warn")]),t._v(" 函数检测 "),n("code",[t._v("hasConsole")]),t._v(" 是否为 true，"),n("code",[t._v("hasConsole")]),t._v(" 的定义如下：")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hasConsole "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" console "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'undefined'")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("接着，"),s("code",[this._v("warn")]),this._v(" 函数检测 "),s("code",[this._v("config.silent")]),this._v(" 为非真。如果这些条件都符合，就调用 "),s("code",[this._v("console.error")]),this._v("。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("p",[n("code",[t._v("console.error")]),t._v(" “在开发者工具里的 console 里输出错误信息”。在这，"),n("code",[t._v("console.error")]),t._v(" 输出 “[Vue warn]: ” 和 "),n("code",[t._v("msg")]),t._v(" "),n("code",[t._v("trace")]),t._v(" 的连接字符。"),n("code",[t._v("msg")]),t._v(" 来自 "),n("code",[t._v("warn")]),t._v(" 函数的参数。"),n("code",[t._v("trace")]),t._v(" 设置在 "),n("code",[t._v("warn")]),t._v(" 函数里，用来描述以上更详细的信息。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("我们回顾下，在开发环境下，"),s("code",[this._v("warn")]),this._v(" 函数接收一个字符串和 Vue 实例作为参数，然后调用自定义的错误处理函数或者是默认的 "),s("code",[this._v("console.error")]),this._v("，以提示开发者某一个错误问题。默认的处理器提供了警告信息和溯源功能。")])}],!1,null,null,null);s.default=e.exports}}]);